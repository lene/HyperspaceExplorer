<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>HyperspaceExplorer: HyperspaceExplorer/src/Functions/Taper.H Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_4d15fdf8e4b2ca29393070d0b99c6a43.html">HyperspaceExplorer</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_4faa746cd9dc8a4df9726effa8d3d373.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_b4fbc74815d1a28b912476c5f0c2b897.html">Functions</a>
  </div>
</div>
<div class="contents">
<h1>Taper.H</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef TAPER_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define TAPER_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "Rotope.H"</span>
<a name="l00005"></a>00005 
<a name="l00009"></a>00009 <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> D&gt;
<a name="l00010"></a><a class="code" href="classtaper__base.html">00010</a>     <span class="keyword">class </span><a class="code" href="classtaper__base.html">taper_base</a>: <span class="keyword">public</span> <a class="code" href="classvertex__data.html">vertex_data</a>&lt;D&gt; {
<a name="l00011"></a>00011 
<a name="l00012"></a>00012         <span class="keyword">public</span>:
<a name="l00013"></a>00013 
<a name="l00014"></a>00014             <a class="code" href="classtaper__base.html">taper_base</a>():
<a name="l00015"></a>00015                 <a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;</a>(), _previous_dim(-1), _pre_previous_dim (-1) { }
<a name="l00016"></a>00016             <a class="code" href="classtaper__base.html">taper_base</a>(<span class="keyword">const</span> <a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;</a> &amp;v):
<a name="l00017"></a>00017                     <a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;</a>(v), _previous_dim(-1), _pre_previous_dim (-1) { }
<a name="l00018"></a>00018 
<a name="l00038"></a><a class="code" href="classtaper__base.html#1e9ad5f81bf3da49de37114122bcaf67">00038</a>             <span class="keywordtype">void</span> <a class="code" href="classtaper__base.html#1e9ad5f81bf3da49de37114122bcaf67">taper</a>(<span class="keywordtype">unsigned</span> d) {
<a name="l00039"></a>00039 
<a name="l00040"></a>00040                 <span class="keywordflow">if</span> (d &gt;= D) {
<a name="l00041"></a>00041                     <span class="keywordflow">throw</span> <a class="codeRef" doxygen="libstdc++.tag:" href="a01204.html" title="STL class.">std::logic_error</a>(
<a name="l00042"></a>00042                         <span class="stringliteral">"taper_base::taper() called on a higher dimension"</span>
<a name="l00043"></a>00043                         <span class="stringliteral">" than the vector space allows"</span>);
<a name="l00044"></a>00044                 }
<a name="l00045"></a>00045                 <span class="keywordflow">if</span> (<a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;::_X</a>.size() &lt; 2) {
<a name="l00046"></a>00046                     <span class="keywordflow">throw</span> <a class="codeRef" doxygen="libstdc++.tag:" href="a01204.html" title="STL class.">std::logic_error</a>(
<a name="l00047"></a>00047                         <span class="stringliteral">"taper_base::taper() can only operate on at least two"</span>
<a name="l00048"></a>00048                         <span class="stringliteral">" vertices"</span>);
<a name="l00049"></a>00049                 }
<a name="l00050"></a>00050 
<a name="l00051"></a>00051                 Vector&lt;D&gt; xnew;     <span class="comment">//  connect all vertices to this new vertex</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053                 <span class="keywordflow">if</span> (!alreadyTapered()) {
<a name="l00054"></a>00054                     <span class="comment">/*  if this is the first time we taper an object, we must</span>
<a name="l00055"></a>00055 <span class="comment">                        extrude a new point above the middle of the old object.</span>
<a name="l00056"></a>00056 <span class="comment">                        for all directions except the newly tapered one, the</span>
<a name="l00057"></a>00057 <span class="comment">                        coordinate value is the mean of the old ones.</span>
<a name="l00058"></a>00058 <span class="comment"></span>
<a name="l00059"></a>00059 <span class="comment">                        we can skip the test for the dimension tapered into,</span>
<a name="l00060"></a>00060 <span class="comment">                        because it's all zero by definition anyway.           */</span>
<a name="l00061"></a>00061                     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; vertex_data&lt;D&gt;::_X.size(); ++i) {
<a name="l00062"></a>00062                         xnew += <a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;::_X</a>[i];
<a name="l00063"></a>00063                     }
<a name="l00064"></a>00064                     xnew *= 1./<a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;::_X</a>.size();
<a name="l00065"></a>00065 
<a name="l00066"></a>00066                     <span class="comment">/*  by pythagoras! the coordinate tapered into is</span>
<a name="l00067"></a>00067 <span class="comment">                        sqrt(1-1/2^2)                                         */</span>
<a name="l00068"></a>00068                     xnew[d] = <a class="codeRef" doxygen="libstdc++.tag:" href="a01815.html#b2c9d94b4becdf532618ad9a0a54aade">sqrt</a>(1.-0.25);
<a name="l00069"></a>00069                 } <span class="keywordflow">else</span> {
<a name="l00070"></a>00070                     <span class="comment">/*  copy the last tapered point. it serves as reference,</span>
<a name="l00071"></a>00071 <span class="comment">                        because only the coordinate last tapered into changes</span>
<a name="l00072"></a>00072 <span class="comment">                        (it is halved), in addition to the newly extruded point</span>
<a name="l00073"></a>00073 <span class="comment">                    */</span>
<a name="l00074"></a>00074                     xnew = <a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;::_X</a>.back();
<a name="l00075"></a>00075 
<a name="l00076"></a>00076                     <span class="keywordflow">if</span> (_pre_previous_dim &lt; 0) {
<a name="l00077"></a>00077                         <span class="comment">/*  if we have extruded only once before, we know the</span>
<a name="l00078"></a>00078 <span class="comment">                            short cathetus of the right triangle spanned by the</span>
<a name="l00079"></a>00079 <span class="comment">                            back of the equilateral triangle to be 0.5 - half a</span>
<a name="l00080"></a>00080 <span class="comment">                            unit, because it lies in the center of the previous</span>
<a name="l00081"></a>00081 <span class="comment">                            object.                                           */</span>
<a name="l00082"></a>00082                         xnew[d] = <a class="codeRef" doxygen="libstdc++.tag:" href="a01815.html#b2c9d94b4becdf532618ad9a0a54aade">sqrt</a>(xnew[_previous_dim]*xnew[_previous_dim]-.25);
<a name="l00083"></a>00083                         <span class="comment">/*  consequently, in this dimension the new point lies</span>
<a name="l00084"></a>00084 <span class="comment">                            in the center of the previous edge.               */</span>
<a name="l00085"></a>00085                         xnew[_previous_dim] /= 2.;
<a name="l00086"></a>00086                     } <span class="keywordflow">else</span> {
<a name="l00087"></a>00087                         <span class="comment">/*  we have stored at least two previous extrusions,</span>
<a name="l00088"></a>00088 <span class="comment">                            the cathetus of the new triangle is defined by them.</span>
<a name="l00089"></a>00089 <span class="comment">                        */</span>
<a name="l00090"></a>00090                         xnew[d] = <a class="codeRef" doxygen="libstdc++.tag:" href="a01815.html#b2c9d94b4becdf532618ad9a0a54aade">sqrt</a>(<a class="codeRef" doxygen="libstdc++.tag:" href="a01815.html#42fec2f6c6429a447bea8a40720a143a">fabs</a>(xnew[_previous_dim]*xnew[_previous_dim]-
<a name="l00091"></a>00091                                 xnew[_pre_previous_dim]*xnew[_pre_previous_dim]));
<a name="l00092"></a>00092                         xnew[_previous_dim] /= 2.;
<a name="l00093"></a>00093                     }
<a name="l00094"></a>00094                 }
<a name="l00095"></a>00095                 <a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;::_X</a>.push_back(xnew);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097                 _pre_previous_dim = _previous_dim;
<a name="l00098"></a>00098                 _previous_dim = d;
<a name="l00099"></a>00099             }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101         <span class="keyword">private</span>:
<a name="l00102"></a>00102             <span class="keywordtype">bool</span> alreadyTapered() { <span class="keywordflow">return</span> _previous_dim &gt;= 0; }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104             <span class="keywordtype">int</span> _previous_dim;
<a name="l00105"></a>00105             <span class="keywordtype">int</span> _pre_previous_dim;
<a name="l00106"></a>00106     };
<a name="l00107"></a>00107 
<a name="l00111"></a>00111     <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> D, <span class="keywordtype">unsigned</span> Dmin, <span class="keywordtype">unsigned</span> Dmax&gt;
<a name="l00112"></a><a class="code" href="classTaper.html">00112</a>         <span class="keyword">class </span><a class="code" href="classTaper.html">Taper</a>: <span class="keyword">public</span> <a class="code" href="classTaper.html">Taper</a>&lt;D, Dmin, Dmax-1&gt; {
<a name="l00113"></a>00113             <span class="keyword">public</span>:
<a name="l00114"></a>00114                 <a class="code" href="classTaper.html">Taper</a>(): <a class="code" href="classTaper.html">Taper</a>&lt;D, Dmin, Dmax-1&gt;() { create(); }
<a name="l00115"></a>00115                 <a class="code" href="classTaper.html">Taper</a>(<span class="keyword">const</span> <a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;</a> &amp;v): <a class="code" href="classTaper.html">Taper</a>&lt;D, Dmin, Dmax-1&gt;(v) {
<a name="l00116"></a>00116                     create();
<a name="l00117"></a>00117                 }
<a name="l00118"></a>00118                 <span class="keywordtype">void</span> create() { <a class="code" href="classtaper__base.html#1e9ad5f81bf3da49de37114122bcaf67">taper_base&lt;D&gt;::taper</a>(Dmax); }
<a name="l00119"></a>00119         };
<a name="l00120"></a>00120 
<a name="l00124"></a>00124     <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> D, <span class="keywordtype">unsigned</span> Dmin&gt;
<a name="l00125"></a><a class="code" href="classTaper_3_01D_00_01Dmin_00_01Dmin_01_4.html">00125</a>         <span class="keyword">class </span><a class="code" href="classTaper.html">Taper</a>&lt;D, Dmin, Dmin&gt;: <span class="keyword">public</span> <a class="code" href="classtaper__base.html">taper_base</a>&lt;D&gt; {
<a name="l00126"></a>00126             <span class="keyword">public</span>:
<a name="l00127"></a>00127                 <a class="code" href="classTaper.html">Taper</a>(): <a class="code" href="classtaper__base.html">taper_base&lt;D&gt;</a>() { create(); }
<a name="l00128"></a>00128                 <a class="code" href="classTaper.html">Taper</a>(<span class="keyword">const</span> <a class="code" href="classvertex__data.html">vertex_data&lt;D&gt;</a> &amp;v): <a class="code" href="classtaper__base.html">taper_base&lt;D&gt;</a>(v) {
<a name="l00129"></a>00129                     create();
<a name="l00130"></a>00130                 }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132                 <span class="keywordtype">void</span> create() {
<a name="l00133"></a>00133                     <a class="code" href="classtaper__base.html#1e9ad5f81bf3da49de37114122bcaf67">taper_base&lt;D&gt;::taper</a>(Dmin);
<a name="l00134"></a>00134                 }
<a name="l00135"></a>00135         };
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="preprocessor">#endif</span>
</pre></div></div>
        <hr size="1">
        <address style="text-align: right;">
            <small>
                Generated on Sun Nov 2 01:48:10 2008 for HyperspaceExplorer 0.6.2
                by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a>
                1.5.6
                &nbsp;-&nbsp;
                Hosted by<a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=34073&amp;type=5" width="210" height="62" border="0" align="middle" alt="SourceForge.net Logo" /></a>
            </small>
        </address>
    </body>
</html>
